#!/usr/bin/env ruby

$LIB_DIR = File.join(File.dirname(__FILE__), "..", "lib")
$LOAD_PATH << $LIB_DIR 

require "dsl"
require "command"

def find
  return "project.lab" if File.exists? "project.lab"  # look for project.lab first
  files = Dir.glob("*.lab")
  raise "no lab file found" unless (files)
  files.first
end

LABORATORY = ENV["LABORATORY"] || find
# LABORATORY = ARGV.shift

puts "/// using '#{LABORATORY}' laboratory project"

load LABORATORY

command = Command.new(@laboratory)
command.run(*ARGV)
